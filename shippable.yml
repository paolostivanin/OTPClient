language: c

build_environment: Ubuntu 16.04

branches:
  only:
    - master

compiler:
  - gcc
  - clang

build:
  ci:
    - sudo apt update
    - sudo apt install cmake libgcrypt20-dev libgtk-3-dev libzip-dev libjansson-dev libpng-dev libzbar-dev
    - git clone https://github.com/paolostivanin/libbaseencode.git
    - cd libbaseencode && mkdir build && cd $_
    - cmake .. -DCMAKE_INSTALL_PREFIX=/usr
    - make
    - sudo make install
    - cd ../..
    - git clone https://github.com/paolostivanin/libcotp.git -b v1.0.14
    - cd libcotp && mkdir build && cd $_
    - cmake .. -DCMAKE_INSTALL_PREFIX=/usr
    - make
    - sudo make install
    - cd ../..
    - mkdir build && cd $_
    - cmake .. -DCMAKE_INSTALL_PREFIX=/usr
    - make -j2
    - sudo make install
